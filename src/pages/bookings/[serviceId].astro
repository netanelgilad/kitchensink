---
import BaseLayout from "../../layouts/BaseLayout.astro";
import ServiceBookingPage from "../../react-pages/bookings/[serviceId]";
import { loadBookingServicesServiceConfig } from "../../headless/bookings/booking-services-service";
import { loadBookingAvailabilityServiceConfig } from "../../headless/bookings/booking-availability-service";
import { loadBookingSelectionServiceConfig } from "../../headless/bookings/booking-selection-service";

const { serviceId } = Astro.params;

if (!serviceId) {
  return Astro.redirect("/bookings");
}

// Load initial data for the specific service
const bookingServicesConfig = await loadBookingServicesServiceConfig();
const bookingAvailabilityConfig =
  await loadBookingAvailabilityServiceConfig(serviceId);
const bookingSelectionConfig = await loadBookingSelectionServiceConfig();
---

<BaseLayout>
  <title>Book Service - Professional Services</title>
  <meta
    name="description"
    content="Select your preferred date and time to book this service."
  />

  <ServiceBookingPage
    client:load
    serviceId={serviceId}
    bookingServicesConfig={bookingServicesConfig}
    bookingAvailabilityConfig={bookingAvailabilityConfig}
    bookingSelectionConfig={bookingSelectionConfig}
    slot="body"
  />
</BaseLayout>
